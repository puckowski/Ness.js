const countSubstr=(e,t)=>e.split(t).length-1;function removeQuotedData(e){let t="",r=!1,l=!1,i=!1;for(let n=0;n<e.length;++n){e.substring(0,n);'"'!==e[n]||l||r?"'"!==e[n]||l||r?'"'===e[n]&&r&&!i||"'"===e[n]&&l&&!i?(l=!1,r=!1):'"'===e[n]&&r&&i||"'"===e[n]&&l&&i?i=!1:(i="\\"===e[n],l||r||(t+=e[n])):l=!0:r=!0}return t}function removeComments(e){let t="",r=!1,l=!1,i=!1,n=!1,s=!1,o=!1,a=!1;for(let g=0;g<e.length;++g)'"'!==e[g]||l||r?"'"!==e[g]||l||r?'"'===e[g]&&r&&!i||"'"===e[g]&&l&&!i?(l=!1,r=!1):i=('"'!==e[g]||!r||!i)&&(("'"!==e[g]||!l||!i)&&"\\"===e[g]):l=!0:r=!0,(o||!l&&!r)&&("/"!==e[g]||n?"*"!==e[g]&&(n=!1):n=!0,"/"===e[g]&&o&&s&&(o=!1,a=!0),"*"===e[g]&&n?(t=t.substring(0,t.length-1),o=!0,n=!1):s=!("*"!==e[g]||n||!o)),o||a||(t+=e[g]),a=!1;return t}function seekToFirstUnquotedSemicolon(e,t,r=0){let l="",i=!1,n=!1,s=!1;for(let o=r;o<e.length&&('"'!==e[o]||n||i?"'"!==e[o]||n||i?'"'===e[o]&&i&&!s||"'"===e[o]&&n&&!s?(n=!1,i=!1):s=('"'!==e[o]||!i||!s)&&(("'"!==e[o]||!n||!s)&&"\\"===e[o]):n=!0:i=!0,n||i||(l+=e[o]),e[o]!==t||i||n);++o);return l}function seekToFirstUnquotedSemicolonPreserving(e,t,r=0){let l="",i=!1,n=!1,s=!1;for(let o=r;o<e.length&&('"'!==e[o]||n||i?"'"!==e[o]||n||i?'"'===e[o]&&i&&!s||"'"===e[o]&&n&&!s?(n=!1,i=!1):s=('"'!==e[o]||!i||!s)&&(("'"!==e[o]||!n||!s)&&"\\"===e[o]):n=!0:i=!0,l+=e[o],e[o]!==t||i||n);++o);return l}function seekToFirstUnquotedWord(e,t,r=0){let l="",i=!1,n=!1,s=!1;for(let o=r;o<e.length;++o)if('"'!==e[o]||n||i?"'"!==e[o]||n||i?'"'===e[o]&&i&&!s||"'"===e[o]&&n&&!s?(n=!1,i=!1):s=('"'!==e[o]||!i||!s)&&(("'"!==e[o]||!n||!s)&&"\\"===e[o]):n=!0:i=!0,l+=e[o],e[o]===t[0]&&!i&&!n){let r=!0;for(let l=0;l<t.length;++l)(e.length>o+l&&e[o+l]!==t[l]||e.length<=o+l)&&(r=!1);if(r)break}return l}const trimRules=e=>{for(let t=0;t<e.length;++t)if(void 0!==e[t])if(Array.isArray(e[t]))for(let r=0;r<e[t].length;++r)Array.isArray(e[t][r])?trimRules(e[t][r]):e[t][r]=e[t][r].trim();else e[t]=e[t].trim()},applyScopedCss=e=>{let t="";for(e=removeComments(e);e.length>0;){let r=seekToFirstUnquotedSemicolonPreserving(e,"}"),l=removeQuotedData(r);for(;countSubstr(l,"{")!==countSubstr(l,"}");){let t=seekToFirstUnquotedSemicolonPreserving(e,"}",r.length);if(r+=t,l=removeQuotedData(r),""===t)break}let i=[];const n=[];let s=0;if(countSubstr(l,"{")>1){const l=r;let o=new Map,a=new Map;for(;removeQuotedData(r).includes("{");){let e=seekToFirstUnquotedSemicolonPreserving(r,"{"),t=removeQuotedData(e),l=!1;if(r=r.substring(e.length,r.length),t.includes("}")&&!t.includes(";")){let t=seekToFirstUnquotedSemicolon(e,"}");e=e.substring(t.length,e.length);const r=t.lastIndexOf("}");t=t.substring(0,r),t=t.trim()+";",n[s].push(t),l=!0}let g=t,u=0,h=s;if(!t.includes(";")){let t=e.trim();t.endsWith("{")&&(e=t.substring(0,t.length-1))}for(;t.includes(";");){const g=u;s-=u,u=0;let h="";for(;removeQuotedData(e).includes(";");){const t=seekToFirstUnquotedSemicolonPreserving(e,";");e=e.substring(t.length,e.length),h+=" "+t}let f=removeQuotedData(h);for(;f.includes("}");){let t=seekToFirstUnquotedSemicolonPreserving(h,"}"),r=h.substring(0,t.length-1),l=h.substring(t.length,h.length);h=r,e=l+e,f=removeQuotedData(h),u++}if(t=removeQuotedData(e),t.includes("}")&&!t.includes(";")){let t=seekToFirstUnquotedSemicolon(e,"}");const r=t.lastIndexOf("}");e=e.substring(r,e.length),t=t.substring(0,r),""!==t.trim()&&(t=t.trim()+";",h+=" "+t)}if(!l||l&&""!==h)if(0===g)void 0!==n[s]?Array.isArray(n[s])?(a.has(s)||a.set(s,n[s].length),n[s]=[...n[s],h]):(a.has(s)||a.set(s,0),n[s]=[n[s],h]):(a.has(s)||a.set(s,0),n[s]=h);else if(void 0!==n[s])if("string"==typeof i[s])a.has(s)||a.set(s,0),n[s]=n[s]+" "+h;else if(Array.isArray(n[s])){const e=removeQuotedData(r);let t=e.indexOf(";"),l=e.indexOf("{");if(-1===t&&(t=e.length),-1===l&&(l=e.length),Array.isArray(i[s])&&i[s].length>n[s].length&&t<l){let e=n[s];e[a.get(s)]=e[a.get(s)]+" "+h,n[s]=e}else{let e=n[s];e[o.get(s)]=e[o.get(s)]+" "+h,n[s]=e}}else a.has(s)||a.set(s,0),n[s]=n[s]+" "+h;else a.has(s)||a.set(s,0),n[s]=h;if(0===u){let t=e.trim();t.endsWith("{")&&(e=t.substring(0,t.length-1))}t=removeQuotedData(e)}s=h;let f=0;for(;g.includes("}");)g=g.substring(g.indexOf("}")+1,g.length),s--,f++;for(;g.includes("{");)if(g=g.substring(g.indexOf("{")+1,g.length),s++,0===f){let e=0;if(void 0!==i[s-1])if(Array.isArray(i[s-1])){let t=i[s-1].length;if(Array.isArray(i[s])||(i[s]=[]),void 0!==i[s-1]&&Array.isArray(i[s-1])&&o.set(s-1,i[s-1].length-1),0===i[s].length)for(;t>i[s].length;)i[s].unshift("");else for(e=i[s].length;t>i[s].length;)i[s].push("")}else void 0===i[s]?i[s]=[""]:Array.isArray(i[s])?i[s].unshift(""):Array.isArray(i[s])||(i[s]=["",i[s]]),void 0!==i[s-1]&&Array.isArray(i[s-1])&&o.set(s-1,i[s-1].length-1);else void 0===i[s]?i[s]=[""]:Array.isArray(i[s])?i[s].unshift(""):Array.isArray(i[s])||(i[s]=["",i[s]]),void 0!==i[s-1]&&Array.isArray(i[s-1])&&o.set(s-1,i[s-1].length-1);if(void 0!==n[s-1])if(Array.isArray(n[s-1])){let t=i[s].length;if(Array.isArray(n[s])||(n[s]=[]),0===e)for(;t>n[s].length;)n[s].unshift("");else for(;t>n[s].length;)n[s].push("")}else void 0===n[s]?n[s]=[""]:Array.isArray(n[s])?n[s].unshift(""):Array.isArray(n[s])||(n[s]=["",n[s]]);else void 0===n[s]?n[s]=[""]:Array.isArray(n[s])?n[s].unshift(""):Array.isArray(n[s])||(n[s]=["",n[s]])}else f--;if(void 0!==i[s])if("string"==typeof i[s]){i[s]=[i[s],e];const t=s;for(;s>=0;){for(;void 0!==i[s-1]&&Array.isArray(i[s-1])&&i[s-1].length<i[s].length;)for(i[s-1].push(i[s-1][i[s-1].length-1]);n[s-1].length<i[s-1].length;)n[s-1].push("");s--}s=t}else{i[s]=[...i[s],e];const t=s;for(;s>=0;){for(;void 0!==i[s-1]&&Array.isArray(i[s-1])&&i[s-1].length<i[s].length;)for(i[s-1].push(i[s-1][i[s-1].length-1]);n[s-1].length<i[s-1].length;)n[s-1].push("");s--}s=t}else if(s>1&&void 0!==i[s-1]&&Array.isArray(i[s-1])){i[s]=[];for(let e=0;e<i[s-1].length-1;++e)i[s].push("");i[s].push(e),n[s]=[];for(let e=0;e<i[s-1].length-1;++e)n[s].push("")}else toDupCount=0,i[s]=e,insertedNonArray=!0}let g,u=0;for(let e=n.length-1;e>=1;--e){const t=n[e-1];if(void 0===t)continue;const r=n[e];for(;Array.isArray(t)&&Array.isArray(r)&&t.length<r.length;)t.push("");n[e-1]=t}for(;removeQuotedData(r).includes(";");){const e=u;s-=u,u=0;let t="";for(;r.includes(";");){const e=seekToFirstUnquotedSemicolonPreserving(r,";");r=r.substring(e.length,r.length),t+=" "+e}let l=removeQuotedData(t);for(;l.includes("}");){let e=seekToFirstUnquotedSemicolonPreserving(t,"}"),i=t.substring(0,e.length-1);r=t.substring(e.length,t.length)+r,t=i,u++,l=removeQuotedData(t)}if(0===e)void 0!==n[s]?"string"==typeof i[s]?(a.has(s)||a.set(s,0),n[s]=[n[s],t]):Array.isArray(n[s])?(a.has(s)||a.set(s,n[s].length),n[s]=[...n[s],t]):(a.has(s)||a.set(s,0),n[s]=[n[s],t]):(a.has(s)||a.set(s,0),n[s]=t);else if(void 0!==n[s])if("string"==typeof i[s])a.has(s)||a.set(s,0),n[s]=n[s]+" "+t;else if(Array.isArray(n[s])){const e=removeQuotedData(r);let l=e.indexOf(";"),g=e.indexOf("{");if(-1===l&&(l=e.length),-1===g&&(g=e.length),Array.isArray(i[s])&&i[s].length>n[s].length&&l<g){let e=n[s];e[a.get(s)]=e[a.get(s)]+" "+t,n[s]=e}else{let e=n[s];e[o.get(s)]=e[o.get(s)]+" "+t,n[s]=e}}else a.has(s)||a.set(s,0),n[s]=n[s]+" "+t;else a.has(s)||a.set(s,0),n[s]=t}if(r.length>0&&removeQuotedData(r).includes("}")){let e=seekToFirstUnquotedSemicolon(r,"}");const t=e.lastIndexOf("}");e=e.substring(0,t),e=e.trim()+";",n[s].push(e)}trimRules(n),e=e.substring(l.length,e.length);for(let e=0;e<i.length;++e)if(void 0!==i[e])if(Array.isArray(i[e]))for(let t=0;t<i[e].length;++t){let r=removeQuotedData(i[e][t]);do{if(r.includes("}")){let r=seekToFirstUnquotedSemicolonPreserving(i[e][t],"}"),l=i[e][t].substring(0,r.length-1),n=i[e][t].substring(r.length,i[e][t].length);i[e][t]=l+n}r=removeQuotedData(i[e][t])}while(r.includes("}"))}else{let t=removeQuotedData(i[e]);do{if(t.includes("}")){let t=seekToFirstUnquotedSemicolonPreserving(i[e],"}"),r=i[e].substring(0,t.length-1),l=i[e].substring(t.length,i[e].length);i[e]=r+l}t=removeQuotedData(i[e])}while(t.includes("}"))}for(let e=0;e<i.length;++e)if(void 0!==i[e])if(Array.isArray(i[e]))for(let t=0;t<i[e].length;++t){let r=removeQuotedData(i[e][t]);do{if(r.includes("@nest")){let r=seekToFirstUnquotedWord(i[e][t],"@nest"),l=i[e][t].substring(0,r.length-5),n=i[e][t].substring(r.length+4,i[e][t].length);i[e][t]=l+n}r=removeQuotedData(i[e][t])}while(r.includes("@nest"))}else{let t=removeQuotedData(i[e]);do{if(t.includes("@nest")){let t=seekToFirstUnquotedWord(i[e],"@nest"),r=i[e].substring(0,t.length-5),l=i[e].substring(t.length+4,i[e].length);i[e]=r+l}t=removeQuotedData(i[e])}while(t.includes("@nest"))}for(let e=0;e<i.length;++e)if(void 0!==i[e])if(Array.isArray(i[e]))for(let t=0;t<i[e].length;++t)i[e][t]=i[e][t].trim();else i[e]=i[e].trim();const h=new Map;for(let e=0;e<i.length;++e)void 0!==i[e]&&h.set(e,[]);void 0!==n[0]&&void 0===i[0]&&(t+=n[0]+" ");for(let e=0;e<i.length;++e)if(void 0!==i[e])if(Array.isArray(i[e]))for(let t=0;t<i[e].length;++t){let r=t;for(let t=0;t<=e;t++)if(void 0!==i[t])if(Array.isArray(i[t])&&i[t].length>r){let l=removeQuotedData(i[t][r]);for(;l.includes(",");){let s=seekToFirstUnquotedSemicolonPreserving(i[t][r],","),o=i[t][r].substring(0,s.length-1),a=i[t][r].substring(s.length,i[t][r].length);o.trim().startsWith("@media")&&!a.trim().startsWith("@media")&&(a="@media "+a),i[t][r]=a,i[t].splice(r,0,o),n[t].splice(r,0,n[t][r]);for(let t=0;t<i.length;++t)t!==e&&void 0!==i[t]&&(Array.isArray(i[t])&&i[t].length>r?i[t].splice(r,0,i[t][r]):Array.isArray(i[t])&&i[t].length===r||0===r&&(i[t]=[i[t],i[t]]));for(let t=0;t<n.length;++t)t!==e&&void 0!==n[t]&&(Array.isArray(n[t])&&n[t].length>r?n[t].splice(r,0,n[t][r]):Array.isArray(n[t])&&n[t].length===r||0===r&&(n[t]=[n[t],n[t]]));l=removeQuotedData(i[t][r])}}else if(!Array.isArray(i[t])){let l=removeQuotedData(i[t]);for(;l.includes(",");){let n=seekToFirstUnquotedSemicolonPreserving(i[t],","),s=i[t].substring(0,n.length-1),o=i[t].substring(n.length,i[t].length);s.trim().startsWith("@media")&&!o.trim().startsWith("@media")&&(o="@media "+o),i[t]=o,i[t]=[i[t],s],l=removeQuotedData(i[t][r]);for(let t=e+1;t<i.length;++t)Array.isArray(i[t])&&i[t].length>r?i[t].splice(r,0,i[t][r]):0===r&&(i[t]=[i[t],i[t]])}}}else{n[e];let t=0;for(let r=0;r<=e;r++)if(void 0!==i[r])if(Array.isArray(i[r])){let l=removeQuotedData(i[r][t]);for(;l.includes(",");){let n=seekToFirstUnquotedSemicolonPreserving(i[r][t],","),s=i[r][t].substring(0,n.length-1),o=i[r][t].substring(n.length,i[r][t].length);s.trim().startsWith("@media")&&!o.trim().startsWith("@media")&&(o="@media "+o),i[r][t]=o,i[r].splice(t,0,s),l=removeQuotedData(i[r][t]);for(let r=e+1;r<i.length;++r)Array.isArray(i[r])&&i[r].length>t?i[r].splice(t,0,i[r][t]):0===t&&(i[r]=[i[r],i[r]])}}else{let l=removeQuotedData(i[r]);for(;l.includes(",");){let n=seekToFirstUnquotedSemicolonPreserving(i[r],","),s=i[r].substring(0,n.length-1),o=i[r].substring(n.length,i[r].length);s.trim().startsWith("@media")&&!o.trim().startsWith("@media")&&(o="@media "+o),i[r]=o,i[r]=[i[r],s],l=removeQuotedData(i[r][t]);for(let r=e+1;r<i.length;++r)Array.isArray(i[r])&&i[r].length>t?i[r].splice(t,0,i[r][t]):0===t&&(i[r]=[i[r],i[r]])}}}for(let e=0;e<i.length;++e)if(void 0!==i[e])if(Array.isArray(i[e]))for(let r=i[e].length-1;r>=0;--r){const l=n[e][r];let s="",o=r,a=-1;for(let t=0;t<=e;t++)if(void 0!==i[t])if(Array.isArray(i[t])&&i[t].length>o){let r=removeQuotedData(i[t][o]);const l=h.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(i[t][o],","),n=i[t][o].substring(0,l.length-1),s=i[t][o].substring(l.length,i[t][o].length);i[t][o]=s,i[t].splice(o,0,n);for(let t=e+1;t<i.length;++t)Array.isArray(i[t])&&i[t].length>o?i[t].splice(o,0,i[t][o]):0===o&&(i[t]=[i[t],i[t]]);r=removeQuotedData(i[t][o])}if(i[t][o].trim().startsWith(":")){if(""!==i[t][o]){s=s.trim()+i[t][o].trim()+" ",g=i[t][o].trim();for(let r=0;r<l;++r)h.get(e)[r].value=h.get(e)[r].value.trim()+i[t][o].trim()+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+i[t][o].trim()+" ",e-1>a&&(a=e-1))}))}}else if(""!==i[t][o]){s+=i[t][o]+" ",g=i[t][o];for(let r=0;r<l;++r)h.get(e)[r].value+=i[t][o]+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value+=i[t][o].trim()+" ",e-1>a&&(a=e-1))}))}}else if(!Array.isArray(i[t])){let r=removeQuotedData(i[t]);const l=h.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(i[t],","),n=i[t].substring(0,l.length-1),s=i[t].substring(l.length,i[t].length);i[t]=s,i[t]=[i[t],n],r=removeQuotedData(i[t][o]);for(let t=e+1;t<i.length;++t)Array.isArray(i[t])&&i[t].length>o?i[t].splice(o,0,i[t][o]):0===o&&(i[t]=[i[t],i[t]])}if(i[t].trim().startsWith(":")){if(""!==i[t]){s=s.trim()+i[t].trim()+" ",g=i[t].trim();for(let r=0;r<l;++r)h.get(e)[r].value=h.get(e)[r].value.trim()+i[t].trim()+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+i[t].trim()+" ",e-1>a&&(a=e-1))}))}}else if(""!==i[t]){s+=i[t]+" ",g=i[t];for(let r=0;r<l;++r)h.get(e)[r].value+=i[t]+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value+=i[t]+" ",e-1>a&&(a=e-1))}))}}if(s&&l){const e=formatMediaQuery(s);if(null===e)t+=s+"{"+l+"}\n";else{""!==e[1].trim()?t+=e[0]+"{"+e[1]+"{"+l+"} }\n":t+=e[0]+"{"+l+"}";for(let r=0;r<e[2];++r)t+="} "}}for(let r=0;r<h.get(e).length;++r){const i=formatMediaQuery(h.get(e)[r].value);if(null===i)t+=h.get(e)[r].value+"{"+l+"}\n";else{""!==i[1].trim()?t+=i[0]+"{"+i[1]+"{"+l+"} }\n":t+=i[0]+"{"+l+"}";for(let e=0;e<i[2];++e)t+="} "}}for(;a>=0;--a)if(void 0!==h.get(a))for(let e=0;e<h.get(a).length;++e){const r=formatMediaQuery(h.get(a)[e].value);if(null===r)t+=h.get(a)[e].value+"{"+l+"}\n";else{""!==r[1].trim()?t+=r[0]+"{"+r[1]+"{"+l+"} }\n":t+=r[0]+"{"+l+"}";for(let e=0;e<r[2];++e)t+="} "}h.get(a)[e].value=h.get(a)[e].origValue}}else{const r=n[e];let l="",s=0,o=-1;for(let t=0;t<=e;t++)if(void 0!==i[t])if(Array.isArray(i[t])){let r=removeQuotedData(i[t][s]);const n=h.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(i[t][s],","),n=i[t][s].substring(0,l.length-1),o=i[t][s].substring(l.length,i[t][s].length);i[t][s]=o,i[t].splice(s,0,n),r=removeQuotedData(i[t][s]);for(let t=e+1;t<i.length;++t)Array.isArray(i[t])&&i[t].length>s?i[t].splice(s,0,i[t][s]):0===s&&(i[t]=[i[t],i[t]])}if(i[t][s].trim().startsWith(":")){if(""!==i[t][s]){l=l.trim()+i[t][s].trim()+" ",g=i[t][s].trim();for(let r=0;r<n;++r)h.get(e)[r].value=h.get(e)[r].value.trim()+i[t][s].trim()+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+i[t][s].trim()+" ",e-1>o&&(o=e-1))}))}}else if(""!==i[t][s]){l+=i[t][s]+" ",g=i[t][s];for(let r=0;r<n;++r)h.get(e)[r].value+=i[t][s]+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value+=i[t][s].trim()+" ",e-1>o&&(o=e-1))}))}}else{let r=removeQuotedData(i[t]);const n=h.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(i[t],","),n=i[t].substring(0,l.length-1),o=i[t].substring(l.length,i[t].length);i[t]=o,i[t]=[i[t],n],r=removeQuotedData(i[t][s]);for(let t=e+1;t<i.length;++t)Array.isArray(i[t])&&i[t].length>s?i[t].splice(s,0,i[t][s]):0===s&&(i[t]=[i[t],i[t]])}if(i[t].trim().startsWith(":")){if(""!==i[t]){l=l.trim()+i[t].trim()+" ",g=i[t].trim();for(let r=0;r<n;++r)h.get(e)[r].value=h.get(e)[r].value.trim()+i[t].trim()+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+i[t].trim()+" ",e-1>o&&(o=e-1))}))}}else if(""!==i[t]){l+=i[t]+" ",g=i[t];for(let r=0;r<n;++r)h.get(e)[r].value+=i[t]+" ";for(const[r,l]of h)r<e&&l.forEach((r=>{t>r.idx&&(r.value+=i[t]+" ",e-1>o&&(o=e-1))}))}}if(l&&r){const e=formatMediaQuery(l);if(null===e)t+=l+"{"+r+"}\n";else{""!==e[1].trim()?t+=e[0]+"{"+e[1]+"{"+r+"} }\n":t+=e[0]+"{"+r+"}";for(let r=0;r<e[2];++r)t+="} "}}for(let l=0;l<h.get(e).length;++l){const i=formatMediaQuery(h.get(e)[l].value);if(null===i){t+=h.get(e)[l].value+"{"+r+"}\n";for(let t=e-1;t>=0;--t)if(void 0!==h.get(t)){const e=[];for(let r=0;r<h.get(t).length;++r){const l={};l.origValue=h.get(t)[r].origValue+" "+g,l.value=h.get(t)[r].value+" "+g,l.idx=h.get(t)[r].idx,e.push(l)}const r=h.get(t).concat(e);h.set(t,r)}}else{""!==i[1].trim()?t+=i[0]+"{"+i[1]+"{"+r+"} }\n":t+=i[0]+"{"+r+"}";for(let e=0;e<i[2];++e)t+="} "}}for(;o>=0;--o)if(void 0!==h.get(o))for(let e=0;e<h.get(o).length;++e){const l=formatMediaQuery(h.get(o)[e].value);if(null===l)t+=h.get(o)[e].value+"{"+r+"}\n";else{""!==l[1].trim()?t+=l[0]+"{"+l[1]+"{"+r+"} }\n":t+=l[0]+"{"+r+"}";for(let e=0;e<l[2];++e)t+="} "}h.get(o)[e].value=h.get(o)[e].origValue}}}else e=e.substring(r.length,e.length),t+=r.trim()+"\n"}return t=formatAppendedChildren(t),t},formatAppendedChildren=e=>{let t=removeQuotedData(e);const r=/[^\s]*\s/;if(t.includes("&"))do{let l=seekToFirstUnquotedSemicolonPreserving(e,"&");if(""===l)break;let i=e.substring(0,l.length-1),n=e.substring(l.length,e.length);n.trim().startsWith("&")&&(n=n.trim().substring(1,n.length));const s=n.match(r);!s||0===s.length&&n.length>0?e=i+" "+n:s&&s.length>0&&s[0].trim().length>0?(i=i.trim(),e=i+n):e=i+" "+n,t=removeQuotedData(e)}while(t.includes("&"));return e},atSet=new Set(["@media","@layer"]),toWhitespacePattern=/[^\s]*\s/,formatMediaQuery=e=>{let t=removeQuotedData(e),r="",l=0;for(const i of atSet)for(;t.includes(i);){let n=seekToFirstUnquotedWord(e,i),s=e.substring(0,n.length-1),o=e.substring(n.length-1,e.length),a=o.substring(0,o.indexOf(i)+i.length);o=o.substring(a.length,o.length).trim();let g="",u=seekToFirstUnquotedSemicolon(o," ");for(u.length>g&&(g=u),u=seekToFirstUnquotedSemicolon(o,"{"),u.length>g&&(g=u),!o.includes(" ")&&g.length<o&&(g=o);g.includes("(")&&countSubstr(g,"(")!==countSubstr(g,")");)g=o.substring(0,o.indexOf(")",g.length)+1);o=o.substring(g.length,o.length),a+=" "+g,t=removeQuotedData(o);let h="";for(;t.includes("and");){n=seekToFirstUnquotedWord(o,"and");let e=o.substring(0,n.length-1),l=o.substring(n.length+2,o.length).trim(),i=l.match(toWhitespacePattern);if(i&&0!==i.length)if(i&&i.length>0){let t=removeQuotedData(i[0]);l=l.substring(i[0].length,l.length);let r=i[0],n=r.length+3+e.length;for(;countSubstr(t,"(")!==countSubstr(t,")")&&(i=l.match(toWhitespacePattern),i&&i.length>0);)r+=" "+i[0],n+=i[0].length,t=removeQuotedData(r);h+=" "+e+" and "+r,o=o.substring(n,o.length)}else i&&i.length>0&&(r+=" "+i[0]+" ");else r+=" and "+l,o="";t=removeQuotedData(o)}""===r?r+=a:"@media"===i?r+=" and "+a:"@layer"===i&&(r+=" { "+a,l++),r+=" "+h,0===l?e=s+" "+o:(""!==s.trim()&&(o=s+" "+o),e=" "+o),t=removeQuotedData(e)}return""!==r?[r,e,l]:null},externalSheets=document.querySelectorAll("link");for(const e of externalSheets)"stylesheet"===e.rel&&fetch(e.href).then((e=>e.text())).then((t=>{var r=document.createElement("style");r.textContent=applyScopedCss(t),document.head.appendChild(r),document.head.removeChild(e)}));