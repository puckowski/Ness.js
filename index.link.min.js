const countSubstr=(e,t)=>e.split(t).length-1;function removeQuotedData(e){let t="",r=!1,l=!1,n=!1;for(let i=0;i<e.length;++i)'"'!==e[i]||l||r?"'"!==e[i]||l||r?'"'===e[i]&&r&&!n||"'"===e[i]&&l&&!n?(l=!1,r=!1):'"'===e[i]&&r&&n||"'"===e[i]&&l&&n?n=!1:(n="\\"===e[i],l||r||(t+=e[i])):l=!0:r=!0;return t}function removeComments(e){let t="",r=!1,l=!1,n=!1,i=!1,s=!1,o=!1,g=!1;for(let a=0;a<e.length;++a)'"'!==e[a]||l||r?"'"!==e[a]||l||r?'"'===e[a]&&r&&!n||"'"===e[a]&&l&&!n?(l=!1,r=!1):n=('"'!==e[a]||!r||!n)&&(("'"!==e[a]||!l||!n)&&"\\"===e[a]):l=!0:r=!0,(o||!l&&!r)&&("/"!==e[a]||i?"*"!==e[a]&&(i=!1):i=!0,"/"===e[a]&&o&&s&&(o=!1,g=!0),"*"===e[a]&&i?(t=t.substring(0,t.length-1),o=!0,i=!1):s=!("*"!==e[a]||i||!o)),o||g||(t+=e[a]),g=!1;return t}function seekToFirstUnquotedSemicolon(e,t,r=0){let l="",n=!1,i=!1,s=!1;for(let o=r;o<e.length&&('"'!==e[o]||i||n?"'"!==e[o]||i||n?'"'===e[o]&&n&&!s||"'"===e[o]&&i&&!s?(i=!1,n=!1):s=('"'!==e[o]||!n||!s)&&(("'"!==e[o]||!i||!s)&&"\\"===e[o]):i=!0:n=!0,i||n||(l+=e[o]),e[o]!==t||n||i);++o);return l}function seekToFirstUnquotedSemicolonPreserving(e,t,r=0){let l="",n=!1,i=!1,s=!1;for(let o=r;o<e.length&&('"'!==e[o]||i||n?"'"!==e[o]||i||n?'"'===e[o]&&n&&!s||"'"===e[o]&&i&&!s?(i=!1,n=!1):s=('"'!==e[o]||!n||!s)&&(("'"!==e[o]||!i||!s)&&"\\"===e[o]):i=!0:n=!0,l+=e[o],e[o]!==t||n||i);++o);return l}function seekToFirstUnquotedWord(e,t,r=0){let l="",n=!1,i=!1,s=!1;for(let o=r;o<e.length;++o)if('"'!==e[o]||i||n?"'"!==e[o]||i||n?'"'===e[o]&&n&&!s||"'"===e[o]&&i&&!s?(i=!1,n=!1):s=('"'!==e[o]||!n||!s)&&(("'"!==e[o]||!i||!s)&&"\\"===e[o]):i=!0:n=!0,l+=e[o],e[o]===t[0]&&!n&&!i){let r=!0;for(let l=0;l<t.length;++l)(e.length>o+l&&e[o+l]!==t[l]||e.length<=o+l)&&(r=!1);if(r)break}return l}const trimRules=e=>{for(let t=0;t<e.length;++t)if(void 0!==e[t])if(Array.isArray(e[t]))for(let r=0;r<e[t].length;++r)Array.isArray(e[t][r])?trimRules(e[t][r]):e[t][r]=e[t][r].trim();else e[t]=e[t].trim()},applyScopedCss=e=>{let t="";for(e=removeComments(e);e.length>0;){let r=seekToFirstUnquotedSemicolonPreserving(e,"}"),l=removeQuotedData(r);for(;countSubstr(l,"{")!==countSubstr(l,"}");){let t=seekToFirstUnquotedSemicolonPreserving(e,"}",r.length);if(r+=t,l=removeQuotedData(r),""===t)break}let n=[];const i=[];let s=0;if(countSubstr(l,"{")>1){const l=r;let o=new Map,g=new Map;for(;removeQuotedData(r).includes("{");){let e=seekToFirstUnquotedSemicolonPreserving(r,"{"),t=removeQuotedData(e),l=!1;if(r=r.substring(e.length,r.length),t.includes("}")&&!t.includes(";")){let t=seekToFirstUnquotedSemicolon(e,"}");e=e.substring(t.length,e.length);const r=t.lastIndexOf("}");t=t.substring(0,r),t=t.trim()+";",i[s].push(t),l=!0}let a=t,u=0,f=s;if(!t.includes(";")){let t=e.trim();t.endsWith("{")&&(e=t.substring(0,t.length-1))}for(;t.includes(";");){const a=u;s-=u,u=0;let f="";for(;removeQuotedData(e).includes(";");){const t=seekToFirstUnquotedSemicolonPreserving(e,";");e=e.substring(t.length,e.length),f+=" "+t}let h=removeQuotedData(f);for(;h.includes("}");){let t=seekToFirstUnquotedSemicolonPreserving(f,"}"),r=f.substring(0,t.length-1),l=f.substring(t.length,f.length);f=r,e=l+e,h=removeQuotedData(f),u++}if(t=removeQuotedData(e),t.includes("}")&&!t.includes(";")){let t=seekToFirstUnquotedSemicolon(e,"}");const r=t.lastIndexOf("}");e=e.substring(r,e.length),t=t.substring(0,r),""!==t.trim()&&(t=t.trim()+";",f+=" "+t)}if(!l||l&&""!==f)if(0===a)void 0!==i[s]?Array.isArray(i[s])?(g.has(s)||g.set(s,i[s].length),i[s]=[...i[s],f]):(g.has(s)||g.set(s,0),i[s]=[i[s],f]):(g.has(s)||g.set(s,0),i[s]=f);else if(void 0!==i[s])if("string"==typeof n[s])g.has(s)||g.set(s,0),i[s]=i[s]+" "+f;else if(Array.isArray(i[s])){const e=removeQuotedData(r);let t=e.indexOf(";"),l=e.indexOf("{");if(-1===t&&(t=e.length),-1===l&&(l=e.length),Array.isArray(n[s])&&n[s].length>i[s].length&&t<l){let e=i[s];e[g.get(s)]=e[g.get(s)]+" "+f,i[s]=e}else{let e=i[s];e[o.get(s)]=e[o.get(s)]+" "+f,i[s]=e}}else g.has(s)||g.set(s,0),i[s]=i[s]+" "+f;else g.has(s)||g.set(s,0),i[s]=f;if(0===u){let t=e.trim();t.endsWith("{")&&(e=t.substring(0,t.length-1))}t=removeQuotedData(e)}s=f;let h=0;for(;a.includes("}");)a=a.substring(a.indexOf("}")+1,a.length),s--,h++;for(;a.includes("{");)if(a=a.substring(a.indexOf("{")+1,a.length),s++,0===h){let e=0;if(void 0!==n[s-1])if(Array.isArray(n[s-1])){let t=n[s-1].length;if(Array.isArray(n[s])||(n[s]=[]),void 0!==n[s-1]&&Array.isArray(n[s-1])&&o.set(s-1,n[s-1].length-1),0===n[s].length)for(;t>n[s].length;)n[s].unshift("");else for(e=n[s].length;t>n[s].length;)n[s].push("")}else void 0===n[s]?n[s]=[""]:Array.isArray(n[s])?n[s].unshift(""):Array.isArray(n[s])||(n[s]=["",n[s]]),void 0!==n[s-1]&&Array.isArray(n[s-1])&&o.set(s-1,n[s-1].length-1);else void 0===n[s]?n[s]=[""]:Array.isArray(n[s])?n[s].unshift(""):Array.isArray(n[s])||(n[s]=["",n[s]]),void 0!==n[s-1]&&Array.isArray(n[s-1])&&o.set(s-1,n[s-1].length-1);if(void 0!==i[s-1])if(Array.isArray(i[s-1])){let t=n[s].length;if(Array.isArray(i[s])||(i[s]=[]),0===e)for(;t>i[s].length;)i[s].unshift("");else for(;t>i[s].length;)i[s].push("")}else void 0===i[s]?i[s]=[""]:Array.isArray(i[s])?i[s].unshift(""):Array.isArray(i[s])||(i[s]=["",i[s]]);else void 0===i[s]?i[s]=[""]:Array.isArray(i[s])?i[s].unshift(""):Array.isArray(i[s])||(i[s]=["",i[s]])}else h--;if(void 0!==n[s])if("string"==typeof n[s]){n[s]=[n[s],e];const t=s;for(;s>=0;){for(;void 0!==n[s-1]&&Array.isArray(n[s-1])&&n[s-1].length<n[s].length;)for(n[s-1].push(n[s-1][n[s-1].length-1]);i[s-1].length<n[s-1].length;)i[s-1].push("");s--}s=t}else{n[s]=[...n[s],e];const t=s;for(;s>=0;){for(;void 0!==n[s-1]&&Array.isArray(n[s-1])&&n[s-1].length<n[s].length;)for(n[s-1].push(n[s-1][n[s-1].length-1]);i[s-1].length<n[s-1].length;)i[s-1].push("");s--}s=t}else if(s>1&&void 0!==n[s-1]&&Array.isArray(n[s-1])){n[s]=[];for(let e=0;e<n[s-1].length-1;++e)n[s].push("");n[s].push(e),i[s]=[];for(let e=0;e<n[s-1].length-1;++e)i[s].push("")}else toDupCount=0,n[s]=e,insertedNonArray=!0}let a,u=0;for(let e=i.length-1;e>=1;--e){const t=i[e-1];if(void 0===t)continue;const r=i[e];for(;Array.isArray(t)&&Array.isArray(r)&&t.length<r.length;)t.push("");i[e-1]=t}for(;removeQuotedData(r).includes(";");){const e=u;s-=u,u=0;let t="";for(;r.includes(";");){const e=seekToFirstUnquotedSemicolonPreserving(r,";");r=r.substring(e.length,r.length),t+=" "+e}let l=removeQuotedData(t);for(;l.includes("}");){let e=seekToFirstUnquotedSemicolonPreserving(t,"}"),n=t.substring(0,e.length-1);r=t.substring(e.length,t.length)+r,t=n,u++,l=removeQuotedData(t)}if(0===e)void 0!==i[s]?"string"==typeof n[s]?(g.has(s)||g.set(s,0),i[s]=[i[s],t]):Array.isArray(i[s])?(g.has(s)||g.set(s,i[s].length),i[s]=[...i[s],t]):(g.has(s)||g.set(s,0),i[s]=[i[s],t]):(g.has(s)||g.set(s,0),i[s]=t);else if(void 0!==i[s])if("string"==typeof n[s])g.has(s)||g.set(s,0),i[s]=i[s]+" "+t;else if(Array.isArray(i[s])){const e=removeQuotedData(r);let l=e.indexOf(";"),a=e.indexOf("{");if(-1===l&&(l=e.length),-1===a&&(a=e.length),Array.isArray(n[s])&&n[s].length>i[s].length&&l<a){let e=i[s];e[g.get(s)]=e[g.get(s)]+" "+t,i[s]=e}else{let e=i[s];e[o.get(s)]=e[o.get(s)]+" "+t,i[s]=e}}else g.has(s)||g.set(s,0),i[s]=i[s]+" "+t;else g.has(s)||g.set(s,0),i[s]=t}if(r.length>0&&removeQuotedData(r).includes("}")){let e=seekToFirstUnquotedSemicolon(r,"}");const t=e.lastIndexOf("}");e=e.substring(0,t),e=e.trim()+";",i[s].push(e)}trimRules(i),e=e.substring(l.length,e.length);for(let e=0;e<n.length;++e)if(void 0!==n[e])if(Array.isArray(n[e]))for(let t=0;t<n[e].length;++t){let r=removeQuotedData(n[e][t]);do{if(r.includes("}")){let r=seekToFirstUnquotedSemicolonPreserving(n[e][t],"}"),l=n[e][t].substring(0,r.length-1),i=n[e][t].substring(r.length,n[e][t].length);n[e][t]=l+i}r=removeQuotedData(n[e][t])}while(r.includes("}"))}else{let t=removeQuotedData(n[e]);do{if(t.includes("}")){let t=seekToFirstUnquotedSemicolonPreserving(n[e],"}"),r=n[e].substring(0,t.length-1),l=n[e].substring(t.length,n[e].length);n[e]=r+l}t=removeQuotedData(n[e])}while(t.includes("}"))}for(let e=0;e<n.length;++e)if(void 0!==n[e])if(Array.isArray(n[e]))for(let t=0;t<n[e].length;++t){let r=removeQuotedData(n[e][t]);do{if(r.includes("&")){let r=seekToFirstUnquotedSemicolonPreserving(n[e][t],"&"),l=n[e][t].substring(0,r.length-1),i=n[e][t].substring(r.length,n[e][t].length);n[e][t]=l+i}r=removeQuotedData(n[e][t])}while(r.includes("&"))}else{let t=removeQuotedData(n[e]);do{if(t.includes("&")){let t=seekToFirstUnquotedSemicolonPreserving(n[e],"&"),r=n[e].substring(0,t.length-1),l=n[e].substring(t.length,n[e].length);n[e]=r+l}t=removeQuotedData(n[e])}while(t.includes("&"))}for(let e=0;e<n.length;++e)if(void 0!==n[e])if(Array.isArray(n[e]))for(let t=0;t<n[e].length;++t){let r=removeQuotedData(n[e][t]);do{if(r.includes("@nest")){let r=seekToFirstUnquotedWord(n[e][t],"@nest"),l=n[e][t].substring(0,r.length-5),i=n[e][t].substring(r.length+4,n[e][t].length);n[e][t]=l+i}r=removeQuotedData(n[e][t])}while(r.includes("@nest"))}else{let t=removeQuotedData(n[e]);do{if(t.includes("@nest")){let t=seekToFirstUnquotedWord(n[e],"@nest"),r=n[e].substring(0,t.length-5),l=n[e].substring(t.length+4,n[e].length);n[e]=r+l}t=removeQuotedData(n[e])}while(t.includes("@nest"))}for(let e=0;e<n.length;++e)if(void 0!==n[e])if(Array.isArray(n[e]))for(let t=0;t<n[e].length;++t)n[e][t]=n[e][t].trim();else n[e]=n[e].trim();const f=new Map;for(let e=0;e<n.length;++e)void 0!==n[e]&&f.set(e,[]);void 0!==i[0]&&void 0===n[0]&&(t+=i[0]+" ");for(let e=0;e<n.length;++e)if(void 0!==n[e])if(Array.isArray(n[e]))for(let t=0;t<n[e].length;++t){let r=t;for(let t=0;t<=e;t++)if(void 0!==n[t])if(Array.isArray(n[t])&&n[t].length>r){let l=removeQuotedData(n[t][r]);for(;l.includes(",");){let s=seekToFirstUnquotedSemicolonPreserving(n[t][r],","),o=n[t][r].substring(0,s.length-1),g=n[t][r].substring(s.length,n[t][r].length);n[t][r]=g,n[t].splice(r,0,o),i[t].splice(r,0,i[t][r]);for(let t=0;t<n.length;++t)t!==e&&void 0!==n[t]&&(Array.isArray(n[t])&&n[t].length>r?n[t].splice(r,0,n[t][r]):Array.isArray(n[t])&&n[t].length===r||0===r&&(n[t]=[n[t],n[t]]));for(let t=0;t<i.length;++t)t!==e&&void 0!==i[t]&&(Array.isArray(i[t])&&i[t].length>r?i[t].splice(r,0,i[t][r]):Array.isArray(i[t])&&i[t].length===r||0===r&&(i[t]=[i[t],i[t]]));l=removeQuotedData(n[t][r])}}else if(!Array.isArray(n[t])){let l=removeQuotedData(n[t]);for(;l.includes(",");){let i=seekToFirstUnquotedSemicolonPreserving(n[t],","),s=n[t].substring(0,i.length-1),o=n[t].substring(i.length,n[t].length);n[t]=o,n[t]=[n[t],s],l=removeQuotedData(n[t][r]);for(let t=e+1;t<n.length;++t)Array.isArray(n[t])&&n[t].length>r?n[t].splice(r,0,n[t][r]):0===r&&(n[t]=[n[t],n[t]])}}}else{i[e];let t=0;for(let r=0;r<=e;r++)if(void 0!==n[r])if(Array.isArray(n[r])){let l=removeQuotedData(n[r][t]);for(;l.includes(",");){let i=seekToFirstUnquotedSemicolonPreserving(n[r][t],","),s=n[r][t].substring(0,i.length-1),o=n[r][t].substring(i.length,n[r][t].length);n[r][t]=o,n[r].splice(t,0,s),l=removeQuotedData(n[r][t]);for(let r=e+1;r<n.length;++r)Array.isArray(n[r])&&n[r].length>t?n[r].splice(t,0,n[r][t]):0===t&&(n[r]=[n[r],n[r]])}}else{let l=removeQuotedData(n[r]);for(;l.includes(",");){let i=seekToFirstUnquotedSemicolonPreserving(n[r],","),s=n[r].substring(0,i.length-1),o=n[r].substring(i.length,n[r].length);n[r]=o,n[r]=[n[r],s],l=removeQuotedData(n[r][t]);for(let r=e+1;r<n.length;++r)Array.isArray(n[r])&&n[r].length>t?n[r].splice(t,0,n[r][t]):0===t&&(n[r]=[n[r],n[r]])}}}for(let e=0;e<n.length;++e)if(void 0!==n[e])if(Array.isArray(n[e]))for(let r=n[e].length-1;r>=0;--r){const l=i[e][r];let s="",o=r,g=-1;for(let t=0;t<=e;t++)if(void 0!==n[t])if(Array.isArray(n[t])&&n[t].length>o){let r=removeQuotedData(n[t][o]);const l=f.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(n[t][o],","),i=n[t][o].substring(0,l.length-1),s=n[t][o].substring(l.length,n[t][o].length);n[t][o]=s,n[t].splice(o,0,i);for(let t=e+1;t<n.length;++t)Array.isArray(n[t])&&n[t].length>o?n[t].splice(o,0,n[t][o]):0===o&&(n[t]=[n[t],n[t]]);r=removeQuotedData(n[t][o])}if(n[t][o].trim().startsWith(":")){if(""!==n[t][o]){s=s.trim()+n[t][o].trim()+" ",a=n[t][o].trim();for(let r=0;r<l;++r)f.get(e)[r].value=f.get(e)[r].value.trim()+n[t][o].trim()+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+n[t][o].trim()+" ",e-1>g&&(g=e-1))}))}}else if(""!==n[t][o]){s+=n[t][o]+" ",a=n[t][o];for(let r=0;r<l;++r)f.get(e)[r].value+=n[t][o]+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value+=n[t][o].trim()+" ",e-1>g&&(g=e-1))}))}}else if(!Array.isArray(n[t])){let r=removeQuotedData(n[t]);const l=f.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(n[t],","),i=n[t].substring(0,l.length-1),s=n[t].substring(l.length,n[t].length);n[t]=s,n[t]=[n[t],i],r=removeQuotedData(n[t][o]);for(let t=e+1;t<n.length;++t)Array.isArray(n[t])&&n[t].length>o?n[t].splice(o,0,n[t][o]):0===o&&(n[t]=[n[t],n[t]])}if(n[t].trim().startsWith(":")){if(""!==n[t]){s=s.trim()+n[t].trim()+" ",a=n[t].trim();for(let r=0;r<l;++r)f.get(e)[r].value=f.get(e)[r].value.trim()+n[t].trim()+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+n[t].trim()+" ",e-1>g&&(g=e-1))}))}}else if(""!==n[t]){s+=n[t]+" ",a=n[t];for(let r=0;r<l;++r)f.get(e)[r].value+=n[t]+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value+=n[t]+" ",e-1>g&&(g=e-1))}))}}if(s&&l){const e=formatMediaQuery(s);if(null===e)t+=s+"{"+l+"}\n";else{""!==e[1].trim()?t+=e[0]+"{"+e[1]+"{"+l+"} }\n":t+=e[0]+"{"+l+"}";for(let r=0;r<e[2];++r)t+="} "}}for(let r=0;r<f.get(e).length;++r){const n=formatMediaQuery(f.get(e)[r].value);if(null===n)t+=f.get(e)[r].value+"{"+l+"}\n";else{""!==n[1].trim()?t+=n[0]+"{"+n[1]+"{"+l+"} }\n":t+=n[0]+"{"+l+"}";for(let e=0;e<n[2];++e)t+="} "}}for(;g>=0;--g)if(void 0!==f.get(g))for(let e=0;e<f.get(g).length;++e){const r=formatMediaQuery(f.get(g)[e].value);if(null===r)t+=f.get(g)[e].value+"{"+l+"}\n";else{""!==r[1].trim()?t+=r[0]+"{"+r[1]+"{"+l+"} }\n":t+=r[0]+"{"+l+"}";for(let e=0;e<r[2];++e)t+="} "}f.get(g)[e].value=f.get(g)[e].origValue}}else{const r=i[e];let l="",s=0,o=-1;for(let t=0;t<=e;t++)if(void 0!==n[t])if(Array.isArray(n[t])){let r=removeQuotedData(n[t][s]);const i=f.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(n[t][s],","),i=n[t][s].substring(0,l.length-1),o=n[t][s].substring(l.length,n[t][s].length);n[t][s]=o,n[t].splice(s,0,i),r=removeQuotedData(n[t][s]);for(let t=e+1;t<n.length;++t)Array.isArray(n[t])&&n[t].length>s?n[t].splice(s,0,n[t][s]):0===s&&(n[t]=[n[t],n[t]])}if(n[t][s].trim().startsWith(":")){if(""!==n[t][s]){l=l.trim()+n[t][s].trim()+" ",a=n[t][s].trim();for(let r=0;r<i;++r)f.get(e)[r].value=f.get(e)[r].value.trim()+n[t][s].trim()+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+n[t][s].trim()+" ",e-1>o&&(o=e-1))}))}}else if(""!==n[t][s]){l+=n[t][s]+" ",a=n[t][s];for(let r=0;r<i;++r)f.get(e)[r].value+=n[t][s]+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value+=n[t][s].trim()+" ",e-1>o&&(o=e-1))}))}}else{let r=removeQuotedData(n[t]);const i=f.get(e).length;for(;r.includes(",");){let l=seekToFirstUnquotedSemicolonPreserving(n[t],","),i=n[t].substring(0,l.length-1),o=n[t].substring(l.length,n[t].length);n[t]=o,n[t]=[n[t],i],r=removeQuotedData(n[t][s]);for(let t=e+1;t<n.length;++t)Array.isArray(n[t])&&n[t].length>s?n[t].splice(s,0,n[t][s]):0===s&&(n[t]=[n[t],n[t]])}if(n[t].trim().startsWith(":")){if(""!==n[t]){l=l.trim()+n[t].trim()+" ",a=n[t].trim();for(let r=0;r<i;++r)f.get(e)[r].value=f.get(e)[r].value.trim()+n[t].trim()+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value=r.value.trim()+n[t].trim()+" ",e-1>o&&(o=e-1))}))}}else if(""!==n[t]){l+=n[t]+" ",a=n[t];for(let r=0;r<i;++r)f.get(e)[r].value+=n[t]+" ";for(const[r,l]of f)r<e&&l.forEach((r=>{t>r.idx&&(r.value+=n[t]+" ",e-1>o&&(o=e-1))}))}}if(l&&r){const e=formatMediaQuery(l);if(null===e)t+=l+"{"+r+"}\n";else{""!==e[1].trim()?t+=e[0]+"{"+e[1]+"{"+r+"} }\n":t+=e[0]+"{"+r+"}";for(let r=0;r<e[2];++r)t+="} "}}for(let l=0;l<f.get(e).length;++l){const n=formatMediaQuery(f.get(e)[l].value);if(null===n){t+=f.get(e)[l].value+"{"+r+"}\n";for(let t=e-1;t>=0;--t)if(void 0!==f.get(t)){const e=[];for(let r=0;r<f.get(t).length;++r){const l={};l.origValue=f.get(t)[r].origValue+" "+a,l.value=f.get(t)[r].value+" "+a,l.idx=f.get(t)[r].idx,e.push(l)}const r=f.get(t).concat(e);f.set(t,r)}}else{""!==n[1].trim()?t+=n[0]+"{"+n[1]+"{"+r+"} }\n":t+=n[0]+"{"+r+"}";for(let e=0;e<n[2];++e)t+="} "}}for(;o>=0;--o)if(void 0!==f.get(o))for(let e=0;e<f.get(o).length;++e){const l=formatMediaQuery(f.get(o)[e].value);if(null===l)t+=f.get(o)[e].value+"{"+r+"}\n";else{""!==l[1].trim()?t+=l[0]+"{"+l[1]+"{"+r+"} }\n":t+=l[0]+"{"+r+"}";for(let e=0;e<l[2];++e)t+="} "}f.get(o)[e].value=f.get(o)[e].origValue}}}else e=e.substring(r.length,e.length),t+=r.trim()+"\n"}return t},atSet=new Set(["@media","@layer"]),formatMediaQuery=e=>{let t=removeQuotedData(e),r="",l=0;for(const n of atSet)for(;t.includes(n);){let i=seekToFirstUnquotedWord(e,n),s=e.substring(0,i.length-1),o=e.substring(i.length-1,e.length),g=o.substring(0,o.indexOf(n)+n.length);o=o.substring(g.length,o.length).trim();let a="",u=seekToFirstUnquotedSemicolon(o," ");for(u.length>a&&(a=u),u=seekToFirstUnquotedSemicolon(o,"{"),u.length>a&&(a=u),!o.includes(" ")&&a.length<o&&(a=o);a.includes("(")&&countSubstr(a,"(")!==countSubstr(a,")");)a=o.substring(0,o.indexOf(")",a.length)+1);o=o.substring(a.length,o.length),g+=" "+a,""===r?r+=g:"@media"===n?r+=" and "+g:"@layer"===n&&(r+=" { "+g,l++),0===l?e=s+" "+o:(""!==s.trim()&&(o=s+" "+o),e=" "+o),t=removeQuotedData(e)}return""!==r?[r,e,l]:null},externalSheets=document.querySelectorAll("link");for(const e of externalSheets)"stylesheet"===e.rel&&fetch(e.href).then((e=>e.text())).then((t=>{var r=document.createElement("style");r.textContent=applyScopedCss(t),document.head.appendChild(r),document.head.removeChild(e)}));